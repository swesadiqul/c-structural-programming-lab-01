Please don't copy this code. Just use this as a helping partner to solve those problem.